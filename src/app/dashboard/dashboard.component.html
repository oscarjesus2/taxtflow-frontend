<div class="dashboard">

  <!-- ───── Tarjetas resumen ───── -->
  <section class="cards">
    <article class="card">
      <h4>Informes hoy</h4>
      <span class="big">{{ resumen.informesHoy.ok }}/{{ resumen.informesHoy.total }}</span>
      <small>con éxito</small>
    </article>

    <article class="card">
      <h4>Clientes</h4>
      <span class="big">{{ resumen.clientes }}</span>
    </article>

    <article class="card">
      <h4>Licencia</h4>
      <span class="big">{{ resumen.licenciaDias }}</span>
      <small>días restantes</small>
    </article>

    <article class="card">
      <h4>Carga servidor</h4>
      <span class="big">{{ resumen.cpu }} %</span>
      <small>CPU / mem</small>
    </article>
  </section>

  <!-- ───── Tendencia semanal ───── -->
  <section class="chart-box">
    <canvas baseChart
            [datasets]="lineData"
            [labels]="lineLabels"
            chartType="line">
    </canvas>
  </section>

  <!-- ───── Próximas programaciones (acordeón) ───── -->
  <section class="section">
    <h3>Próximas programaciones</h3>
    <ngb-accordion>
      <ngb-panel *ngFor="let prog of proximas" [id]="prog.id + ''">
                 [title]="prog.clienteRuc + ' – ' + prog.tipoInforme + ' ('+ prog.proximoInstante +')'">
        <ng-template ngbPanelContent>
          <p>Frecuencia: {{ prog.frecuencia }} – formato {{ prog.formato }}</p>
          <button class="btn"
                  routerLink="programaciones/{{ prog.id }}">
            Ver historial &gt;
          </button>
        </ng-template>
      </ngb-panel>
    </ngb-accordion>
  </section>

  <!-- ───── Últimos informes ───── -->
  <section class="section">
    <h3>Últimos informes</h3>
    <table>
      <thead>
        <tr><th>Fecha</th><th>Cliente</th><th>Tipo</th><th>Estado</th><th></th></tr>
      </thead>
      <tbody>
        <tr *ngFor="let i of informes">
          <td>{{ i.fecha | date:'short' }}</td>
          <td>{{ i.cliente }}</td>
          <td>{{ i.tipo }}</td>
          <td>
            <span class="badge" [ngClass]="i.estado">{{ i.estado }}</span>
          </td>
          <td>
            <a *ngIf="i.url" [href]="i.url" download rel="noopener">⬇︎</a>
          </td>
        </tr>
      </tbody>
    </table>
  </section>

  <!-- ───── Notificaciones ───── -->
  <section class="alerts">
    <h3>Notificaciones</h3>
    <ul><li *ngFor="let n of notificaciones">{{ n }}</li></ul>
  </section>
</div>
